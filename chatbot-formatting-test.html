<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Formatting Test - Flips & Bidz</title>
    <link rel="stylesheet" href="chatbot-styles.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1f2937;
            margin-bottom: 10px;
        }
        .description {
            color: #6b7280;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
        }
        .test-section h2 {
            color: #374151;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
        }
        .message {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .message-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .message-avatar svg {
            width: 20px;
            height: 20px;
            color: white;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸŽ¨ Chatbot Formatting Test</h1>
        <p class="description">This page demonstrates all the markdown formatting capabilities of the Flips & Bidz AI chatbot.</p>

        <div class="test-section">
            <h2>Headers</h2>
            <div class="message">
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </div>
                <div class="message-content" id="test-headers"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>Bold & Italic</h2>
            <div class="message">
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </div>
                <div class="message-content" id="test-bold"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>Lists</h2>
            <div class="message">
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </div>
                <div class="message-content" id="test-lists"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>Links & Code</h2>
            <div class="message">
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </div>
                <div class="message-content" id="test-code"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>Auction Inventory Example</h2>
            <div class="message">
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </div>
                <div class="message-content" id="test-inventory"></div>
            </div>
        </div>
    </div>

    <script src="chatbot-script.js"></script>
    <script>
        // Create a temporary instance just for formatting
        const formatter = {
            formatMessage(text) {
                const lines = text.split('\n');
                const formatted = [];
                let inList = false;
                let inNumberedList = false;
                let inCodeBlock = false;
                let codeBlockContent = [];

                for (let i = 0; i < lines.length; i++) {
                    let line = lines[i];

                    if (line.trim().startsWith('```')) {
                        if (inCodeBlock) {
                            formatted.push(`<pre><code>${codeBlockContent.join('\n')}</code></pre>`);
                            codeBlockContent = [];
                            inCodeBlock = false;
                        } else {
                            inCodeBlock = true;
                        }
                        continue;
                    }

                    if (inCodeBlock) {
                        codeBlockContent.push(line);
                        continue;
                    }

                    line = line.replace(/`([^`]+)`/g, '<code>$1</code>');
                    line = line.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
                    line = line.replace(/\*([^*]+)\*/g, '<em>$1</em>');

                    if (line.match(/^#{1,6}\s+(.+)$/)) {
                        const level = line.match(/^(#{1,6})/)[1].length;
                        const text = line.replace(/^#{1,6}\s+/, '');
                        formatted.push(`<h${Math.min(level + 2, 6)}>${text}</h${Math.min(level + 2, 6)}>`);
                        continue;
                    }

                    if (line.match(/^\d+\.\s+(.+)$/)) {
                        const text = line.replace(/^\d+\.\s+/, '');
                        if (!inNumberedList) {
                            formatted.push('<ol>');
                            inNumberedList = true;
                        }
                        if (inList) {
                            formatted.push('</ul>');
                            inList = false;
                        }
                        formatted.push(`<li>${text}</li>`);
                        continue;
                    } else if (inNumberedList && !line.match(/^\d+\.\s+(.+)$/)) {
                        formatted.push('</ol>');
                        inNumberedList = false;
                    }

                    if (line.match(/^[-*]\s+(.+)$/)) {
                        const text = line.replace(/^[-*]\s+/, '');
                        if (!inList) {
                            formatted.push('<ul>');
                            inList = true;
                        }
                        if (inNumberedList) {
                            formatted.push('</ol>');
                            inNumberedList = false;
                        }
                        formatted.push(`<li>${text}</li>`);
                        continue;
                    } else if (inList && !line.match(/^[-*]\s+(.+)$/)) {
                        formatted.push('</ul>');
                        inList = false;
                    }

                    if (line.trim() === '---' || line.trim() === '***') {
                        formatted.push('<hr>');
                        continue;
                    }

                    if (line.match(/^>\s+(.+)$/)) {
                        const text = line.replace(/^>\s+/, '');
                        formatted.push(`<blockquote>${text}</blockquote>`);
                        continue;
                    }

                    if (line.trim()) {
                        line = line.replace(
                            /(https?:\/\/[^\s<]+)/g,
                            '<a href="$1" target="_blank" rel="noopener">$1</a>'
                        );
                        formatted.push(`<p>${line}</p>`);
                    } else {
                        formatted.push('<br>');
                    }
                }

                if (inList) formatted.push('</ul>');
                if (inNumberedList) formatted.push('</ol>');

                return formatted.join('');
            }
        };

        // Test cases
        document.getElementById('test-headers').innerHTML = formatter.formatMessage(
            `### Amazon Auction Items\n#### CRAFTSMAN Power Tools\n##### Available Now`
        );

        document.getElementById('test-bold').innerHTML = formatter.formatMessage(
            `This is **bold text** and this is *italic text*. You can also combine **bold and *italic***!`
        );

        document.getElementById('test-lists').innerHTML = formatter.formatMessage(
            `**Available Tools:**\n- CRAFTSMAN V20 Cordless Leaf Blower\n- DEWALT 20-volt Air Inflator\n- Kobalt 24-volt Battery Charger\n\n**Top Bids:**\n1. Lot 13: $9.00\n2. Lot 16: $17.00\n3. Lot 10: $5.00`
        );

        document.getElementById('test-code').innerHTML = formatter.formatMessage(
            `Visit our auction at https://flipsandbidz.hibid.com/ to place bids.\n\nYou can also use the \`bidding API\` or check lot details with:\n\`\`\`\nLot Number: 10\nItem: DEWALT 20-volt Air Inflator\nCurrent Bid: $5.00\n\`\`\``
        );

        document.getElementById('test-inventory').innerHTML = formatter.formatMessage(
            `### Amazon and GM Overstock Auction\n\nHere are some **featured items** from our current auction:\n\n- **Lot 1:** CRAFTSMAN V20 Cordless Battery Handheld Leaf Blower\n- **Lot 10:** DEWALT 20-volt Li-ion Air Inflator  \n- **Lot 13:** CRAFTSMAN 15-Amp 7-1/4-in Circular saw\n\n> This auction closes Sunday at 6:00 PM\n\nFor more details, visit https://flipsandbidz.hibid.com/`
        );
    </script>
</body>
</html>
